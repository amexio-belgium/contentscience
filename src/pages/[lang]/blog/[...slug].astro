---
import { type CollectionEntry, getCollection } from 'astro:content';
import Base from '@layouts/Base.astro';
import FormattedDate from '@components/uielements/FormattedDate.astro';
import HeroHeader from '@components/uicomposition/HeroHeader.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	const paths = posts.map((post) => {
		const [lang, ...slug] = post.slug.split('/');
		return { 
			params: { lang, slug: slug.join('/') || undefined }, 
			props: post 
		};
	});
	return paths;
}

type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await post.render();

---
<Base {...post.data} title={"Amexio Fuse - " + post.data.title}>

	<HeroHeader 
		headline={post.data.title}
		backgroundImage={post.data.heroImage} >	
		<div class="flex flex-row items-center gap-4 text-white">
			<FormattedDate class="font-serif text-base" date={post.data.pubDate} transition:name={post.slug + "_date"} />
			{
				post.data.tags && <p class="font-serif uppercase text-base before:content-['/'] before:font-sans before:mr-4 before:text-secondary">
					{post.data.tags}
				</p>
			}	
		</div>
	</HeroHeader>
	<div class="prose prose-xl prose-invert mx-auto mt-20 mb-40">		
		<Content />
	</div>
</Base>
